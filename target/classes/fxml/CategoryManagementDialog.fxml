<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.heronix.teacher.ui.controller.CategoryManagementDialogController"
      spacing="15" styleClass="dialog-pane"
      prefWidth="700" prefHeight="600">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="10">
        <Label text="Manage Assignment Categories" styleClass="dialog-title"
               style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
    </HBox>

    <Separator/>

    <!-- Info Panel -->
    <VBox spacing="5" styleClass="info-panel" style="-fx-background-color: #e3f2fd; -fx-padding: 10; -fx-background-radius: 5;">
        <Label text="Assignment categories enable weighted grading, drop lowest scores, and extra credit."
               style="-fx-font-size: 11px; -fx-font-weight: bold;"/>
        <Label text="Example: Tests (40%), Homework (30%), Quizzes (20%), Participation (10%)"
               style="-fx-font-size: 10px; -fx-text-fill: #555;"/>
    </VBox>

    <!-- Main Content -->
    <HBox spacing="15" VBox.vgrow="ALWAYS">

        <!-- Categories List -->
        <VBox spacing="10" prefWidth="300">
            <Label text="Existing Categories" styleClass="field-label" style="-fx-font-weight: bold;"/>

            <TableView fx:id="categoriesTable" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="nameColumn" text="Category" prefWidth="150"/>
                    <TableColumn fx:id="weightColumn" text="Weight" prefWidth="80"/>
                    <TableColumn fx:id="dropColumn" text="Drop" prefWidth="60"/>
                </columns>
            </TableView>

            <HBox spacing="10" alignment="CENTER_LEFT">
                <Button text="New Category" onAction="#newCategory" styleClass="button-primary" prefHeight="35" prefWidth="120"/>
                <Button text="Delete" onAction="#deleteCategory" styleClass="button-danger" prefHeight="35" prefWidth="80"/>
            </HBox>
        </VBox>

        <Separator orientation="VERTICAL"/>

        <!-- Category Editor -->
        <VBox spacing="15" VBox.vgrow="ALWAYS" HBox.hgrow="ALWAYS">
            <Label text="Category Details" styleClass="field-label" style="-fx-font-weight: bold;"/>

            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" style="-fx-background-color: transparent;">
                <VBox spacing="15">

                    <!-- Category Name -->
                    <VBox spacing="5">
                        <Label text="Category Name *" styleClass="field-label"/>
                        <TextField fx:id="nameField" promptText="e.g., Tests, Homework, Quizzes" prefHeight="35"/>
                    </VBox>

                    <!-- Description -->
                    <VBox spacing="5">
                        <Label text="Description" styleClass="field-label"/>
                        <TextArea fx:id="descriptionField" promptText="Optional description..."
                                  prefRowCount="2" wrapText="true"/>
                    </VBox>

                    <!-- Weight Percentage -->
                    <VBox spacing="5">
                        <Label text="Weight (% of Final Grade)" styleClass="field-label"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <TextField fx:id="weightField" promptText="e.g., 40" prefHeight="35" prefWidth="100"/>
                            <Label text="%" styleClass="text-secondary"/>
                            <Label text="(Leave blank for equal weighting)"
                                   style="-fx-font-size: 10px; -fx-text-fill: gray;"/>
                        </HBox>
                    </VBox>

                    <!-- Drop Lowest -->
                    <VBox spacing="5">
                        <Label text="Drop Lowest Scores" styleClass="field-label"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Spinner fx:id="dropLowestSpinner" prefWidth="100" editable="true"/>
                            <Label text="Drop the lowest N assignment(s) from this category"
                                   style="-fx-font-size: 10px; -fx-text-fill: gray;"/>
                        </HBox>
                    </VBox>

                    <!-- Drop Highest -->
                    <VBox spacing="5">
                        <Label text="Drop Highest Scores (rare)" styleClass="field-label"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Spinner fx:id="dropHighestSpinner" prefWidth="100" editable="true"/>
                            <Label text="Drop the highest N assignment(s) from this category"
                                   style="-fx-font-size: 10px; -fx-text-fill: gray;"/>
                        </HBox>
                    </VBox>

                    <!-- Extra Credit -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <CheckBox fx:id="extraCreditCheckbox"/>
                        <Label text="Extra Credit Category" styleClass="field-label"/>
                    </HBox>
                    <Label text="Extra credit adds bonus points but doesn't affect points possible"
                           style="-fx-font-size: 10px; -fx-text-fill: gray; -fx-padding: 0 0 0 30;"/>

                    <!-- Display Order -->
                    <VBox spacing="5">
                        <Label text="Display Order" styleClass="field-label"/>
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Spinner fx:id="displayOrderSpinner" prefWidth="100" editable="true"/>
                            <Label text="Lower numbers appear first"
                                   style="-fx-font-size: 10px; -fx-text-fill: gray;"/>
                        </HBox>
                    </VBox>

                    <!-- Active Status -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <CheckBox fx:id="activeCheckbox" selected="true"/>
                        <Label text="Active (visible to teachers)" styleClass="field-label"/>
                    </HBox>

                    <!-- Save/Cancel Buttons -->
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Button text="Clear" onAction="#clearForm" styleClass="button-secondary"
                                prefHeight="35" prefWidth="100"/>
                        <Button fx:id="saveButton" text="Save Category" onAction="#saveCategory"
                                styleClass="button-primary" prefHeight="35" prefWidth="120"/>
                    </HBox>

                </VBox>
            </ScrollPane>
        </VBox>
    </HBox>

    <Separator/>

    <!-- Summary -->
    <VBox spacing="5" styleClass="info-panel" style="-fx-background-color: #f5f5f5; -fx-padding: 10; -fx-background-radius: 5;">
        <Label text="Total Weight:" styleClass="text-bold" style="-fx-font-size: 11px;"/>
        <Label fx:id="totalWeightLabel" text="0%" styleClass="text-secondary" style="-fx-font-size: 11px;"/>
    </VBox>

    <!-- Close Button -->
    <HBox spacing="10" alignment="CENTER_RIGHT">
        <Button text="Close" onAction="#close" styleClass="button-secondary" prefHeight="35" prefWidth="100"/>
    </HBox>

</VBox>
